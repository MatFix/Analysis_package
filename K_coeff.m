function [] = K_coeff(R)

R = R;

% R = 160e-9;
h = 20e-9;
Ms = 490e3;
Aex = 1.05e-11;
mu0 = 4*pi*1e-7;

gamma = 1.760859e11;
d = 2*R;
alpha = 0.03;
CD = 2;

fRes = 337e6;
omega = fRes*2*pi;

Ku1 = (0:0.01:15)*1e3;

%%

lexc = sqrt(2*Aex/(mu0*Ms^2));
rcore = 0.68*lexc*(h/lexc)^(1/3);

a = Aex*log(R/rcore);
b = -Ku1*(R^2)/2;

c = real(((((-1/2)+(1/2).*3.^(-1/2).*(3+(-4).*a.^(-1).*b+2.*2.^(1/3).* ...
  a.^(-1).*b.^2.*(27.*a.^2.*b+2.*b.^3+3.*3.^(1/2).*(27.*a.^4.* ...
  b.^2+4.*a.^2.*b.^4).^(1/2)).^(-1/3)+2.^(2/3).*a.^(-1).*(27.* ...
  a.^2.*b+2.*b.^3+3.*3.^(1/2).*(27.*a.^4.*b.^2+4.*a.^2.*b.^4) ...
  .^(1/2)).^(1/3)).^(1/2)+(1/2).*(2+(-8/3).*a.^(-1).*b+(-2/3) ...
  .*2.^(1/3).*a.^(-1).*b.^2.*(27.*a.^2.*b+2.*b.^3+3.*3.^(1/2) ...
  .*(27.*a.^4.*b.^2+4.*a.^2.*b.^4).^(1/2)).^(-1/3)+(-1/3).* ...
  2.^(2/3).*a.^(-1).*(27.*a.^2.*b+2.*b.^3+3.*3.^(1/2).*(27.* ...
  a.^4.*b.^2+4.*a.^2.*b.^4).^(1/2)).^(1/3)+(1/4).*3.^(1/2).*( ...
  8+16.*a.^(-1).*b).*(3+(-4).*a.^(-1).*b+2.*2.^(1/3).*a.^(-1) ...
  .*b.^2.*(27.*a.^2.*b+2.*b.^3+3.*3.^(1/2).*(27.*a.^4.*b.^2+ ...
  4.*a.^2.*b.^4).^(1/2)).^(-1/3)+2.^(2/3).*a.^(-1).*(27.* ...
  a.^2.*b+2.*b.^3+3.*3.^(1/2).*(27.*a.^4.*b.^2+4.*a.^2.*b.^4) ...
  .^(1/2)).^(1/3)).^(-1/2)).^(1/2)).^(1/2))));

%%

plot(Ku1/1e3,c,'linewidth',1.1)

end